!function(){function e(e){e.addEventListener("click",function(t){t.preventDefault,c.value--;var r=e.parentNode,n=r.parentNode;n.removeChild(r),s()})}function s(){for(var e=document.querySelectorAll(".companions__value"),s=0;s<e.length;s++){var t=e[s];t.innerHTML=s+1}}function t(e,s){var t=e.querySelector(".btn--minus"),r=e.querySelector(".btn--plus"),i=e.querySelector("[type=number]");i.value=s,n(),t.addEventListener("click",function(e){e.preventDefault(),i.value>0&&(i.value--,n())}),r.addEventListener("click",function(e){e.preventDefault(),i.value++,n()})}function r(e,t){var r=e.querySelector(".btn--minus"),n=e.querySelector(".btn--plus"),i=e.querySelector("[type=number]");i.value=t,r.addEventListener("click",function(e){e.preventDefault(),i.value>0&&i.value--;var s=document.querySelector(".companions__item:last-child");a.removeChild(s)}),n.addEventListener("click",function(e){e.preventDefault(),i.value++;var t=document.createElement("li");t.classList.add("companions__item"),t.innerHTML=Mustache.render(l,{"number-$":c.value,"companion-name-$":"companion-name-"+c.value,"companion-niсkname-$":"companion-niсkname-"+c.value}),a.appendChild(t);var r=t.querySelector(".btn--companions");r.addEventListener("click",function(e){e.preventDefault;var r=t.parentNode;r.removeChild(t),i.value--,s()})})}function n(){var e=document.querySelector("[name=departure-date]"),s=document.querySelector("[name=return-date]"),t=+document.querySelector("[name=duration]").value;dateReturn=moment(e.value).add(t,"days").format("YYYY-MM-DD"),s.value=dateReturn}if(document.querySelector(".time__btns-group")){moment().format();var i=document.querySelector(".time__btns-group"),o=document.querySelector(".companions__btns-group"),a=document.querySelector(".companions__list"),l=document.querySelector("#companion-template").innerHTML,c=document.querySelector("[name=companions-amount]"),d=document.querySelectorAll(".btn--companions");t(i,"10"),r(o,"2"),e(d[0]),e(d[1])}}(),function(){function e(e,s){var t=new XMLHttpRequest,r=(new Date).getTime();t.open("post","https://echo.htmlacademy.ru/adaptive?"+r),a.classList.add("btn--in-progress"),t.addEventListener("readystatechange",function(){4==t.readyState&&(a.classList.remove("btn--in-progress"),s(t.responseText))}),t.send(e)}function s(e){if(e.type.match(/image.*/)){var s=new FileReader;s.addEventListener("load",function(s){var r=Mustache.render(i,{image:s.target.result,name:e.name}),a=document.createElement("li");a.classList.add("photos__item"),a.innerHTML=r,n.appendChild(a),a.querySelector(".btn--cross").addEventListener("click",function(e){e.preventDefault(),t(a)}),o.push({file:e,li:a})}),s.readAsDataURL(e)}}function t(e){o=o.filter(function(s){return s.li!=e}),e.parentNode.removeChild(e)}if("FormData"in window&&document.querySelector(".story-form form")){var r=document.querySelector(".story-form form"),n=document.querySelector(".photos__list"),i=document.querySelector("#image-template").innerHTML,o=[],a=r.querySelector(".btn--story-form");r.addEventListener("submit",function(s){s.preventDefault();var t=new FormData(r);o.forEach(function(e){t.append("images",e.file)}),e(t,function(e){console.log(e),l.classList.add("popup-success--show")})}),"FileReader"in window&&r.querySelector("#upload-photos").addEventListener("change",function(){for(var e=this.files,t=0;t<e.length;t++)s(e[t]);this.value=""});for(var l=document.querySelector(".popup-success"),c=document.querySelector(".popup-failure"),d=document.querySelectorAll(".btn--popup"),u=0;u<d.length;u++){var v=d[u];v.addEventListener("click",function(e){e.preventDefault(),l.classList.contains("popup-success--show")?l.classList.remove("popup-success--show"):c.classList.contains("popup-failure--show")&&c.classList.remove("popup-failure--show")})}}}(),function(){function e(){var e={zoom:16,center:new google.maps.LatLng(59.936352,30.321097),disableDefaultUI:!0,scrollwheel:!1},s=new google.maps.Map(document.getElementById("map"),e),t="img/img_map-marker.png",r=new google.maps.LatLng(59.936352,30.321097);new google.maps.Marker({position:r,map:s,icon:t})}document.querySelector(".map")&&google.maps.event.addDomListener(window,"load",e)}(),function(){if(document.querySelector(".navbar")){var e=document.querySelector(".navbar"),s=e.querySelector(".navbar__header"),t=e.querySelector(".navbar__nav"),r=e.querySelector(".navbar__toggle"),n=e.querySelector(".navbar__lines"),i=1;r.addEventListener("click",function(e){e.preventDefault(),i++,i%2?i%2&&(s.classList.remove("navbar__header--active"),n.classList.remove("navbar__lines--cross"),t.classList.remove("navbar__nav--drop-down")):(s.classList.add("navbar__header--active"),n.classList.add("navbar__lines--cross"),t.classList.add("navbar__nav--drop-down"))})}}(),function(){if(document.querySelector(".reviews-slider")){var e=document.querySelector(".reviews-slider"),s=e.querySelectorAll(".reviews-slider__control"),t=s[0],r=s[1],n=s[2],i=e.querySelector(".reviews-slider__btn-next"),o=e.querySelector(".reviews-slider__btn-prev"),a=e.querySelector(".reviews-slider__slides"),l=0;a.classList.add("reviews-slider__slides--show-first"),t.addEventListener("click",function(){a.classList.remove("reviews-slider__slides--show-second"),a.classList.remove("reviews-slider__slides--show-third"),a.classList.add("reviews-slider__slides--show-first")}),r.addEventListener("click",function(){a.classList.remove("reviews-slider__slides--show-first"),a.classList.remove("reviews-slider__slides--show-third"),a.classList.add("reviews-slider__slides--show-second")}),n.addEventListener("click",function(){a.classList.remove("reviews-slider__slides--show-first"),a.classList.remove("reviews-slider__slides--show-second"),a.classList.add("reviews-slider__slides--show-third")}),o.classList.add("reviews-slider__btn-prev--disabled"),i.addEventListener("click",function(e){e.preventDefault(),l++,l>2&&(l=2),1==l?(a.classList.remove("reviews-slider__slides--show-first"),a.classList.add("reviews-slider__slides--show-second"),o.classList.remove("reviews-slider__btn-prev--disabled")):2==l&&(a.classList.remove("reviews-slider__slides--show-second"),a.classList.add("reviews-slider__slides--show-third"),i.classList.add("reviews-slider__btn-next--disabled"))}),o.addEventListener("click",function(e){e.preventDefault(),l--,0>l&&(l=0),0==l?(a.classList.remove("reviews-slider__slides--show-second"),a.classList.add("reviews-slider__slides--show-first"),o.classList.add("reviews-slider__btn-prev--disabled")):1==l&&(a.classList.remove("reviews-slider__slides--show-third"),a.classList.add("reviews-slider__slides--show-second"),i.classList.remove("reviews-slider__btn-next--disabled"))})}}();